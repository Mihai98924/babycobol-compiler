lock testLock;

fork {
    sync testLock {
        int i = 0;
        while (i < 3000) {
            i = i + 1;
        }
    }
    printNL "1 DONE!";
}

fork {
    int i = 0;
    while (i < 6000) {
        i = i + 1;
    }
    printNL "2 DONE!";
}

fork {
    int i = 0;
    while (i < 9000) {
        i = i + 1;
    }
    printNL "3 DONE!";
}

printNL "wait for 3";
join;
printNL "wait for 2";
join;
printNL "wait for 1";
join;
